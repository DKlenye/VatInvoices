using Naftan.VatInvoices.Domain;

namespace Naftan.VatInvoices.QueryObjects
{
    public class InsertVatInvoice
    {
        public QueryObject Query(VatInvoice invoice)
        {
            return new QueryObject(@"

            INSERT INTO VatInvoice
            (
	            IsIncome,
	            ReplicationSourceId,
	            ReplicationId,
	            BuySaleTypeId,
	            VatAccount,
	            Account,
	            StatusId,
	            Sender,
	            [Year],
	            Number,
	            NumberString,
	            DateIssuance,
	            DateTransaction,
	            InvoiceTypeId,
	            OriginalInvoiceNumber,
	            SendToRecipient,
	            DateCancelled,
	            ProviderCounteragentId,
	            ProviderStatusId,
	            ProviderDependentPerson,
	            ProviderResidentsOfOffshore,
	            ProviderSpecialDealGoods,
	            ProviderBigCompany,
	            ProviderCountryCode,
	            ProviderUnp,
	            ProviderBranchCode,
	            ProviderName,
	            ProviderAddress,
	            PrincipalInvoiceNumber,
	            PrincipalInvoiceDate,
	            VendorInvoiceNumber,
	            VendorInvoiceDate,
	            ProviderDeclaration,
	            DateRelease,
	            DateActualExport,
	            ProviderTaxeNumber,
	            ProviderTaxeDate,
	            RecipientCounteragentId,
	            RecipientStatusId,
	            RecipientDependentPerson,
	            RecipientResidentsOfOffshore,
	            RecipientSpecialDealGoods,
	            RecipientBigCompany,
	            RecipientCountryCode,
	            RecipientUnp,
	            RecipientBranchCode,
	            RecipientName,
	            RecipientAddress,
	            RecipientDeclaration,
	            RecipientTaxeNumber,
	            RecipientTaxeDate,
	            DateImport,
	            ContractId,
	            ContractNumber,
	            ContractDate,
	            ContractDescription,
	            RosterTotalCostVat,
	            RosterTotalExcise,
	            RosterTotalVat,
	            RosterTotalCost,
	            ApproveDate
            )
            VALUES
            (
	            @IsIncome,
	            @ReplicationSourceId,
	            @ReplicationId,
	            @BuySaleTypeId,
	            @VatAccount,
	            @Account,
	            @StatusId,
	            @Sender,
	            @Year,
	            @Number,
	            @NumberString,
	            @DateIssuance,
	            @DateTransaction,
	            @InvoiceTypeId,
	            @OriginalInvoiceNumber,
	            @SendToRecipient,
	            @DateCancelled,
	            @ProviderCounteragentId,
	            @ProviderStatusId,
	            @ProviderDependentPerson,
	            @ProviderResidentsOfOffshore,
	            @ProviderSpecialDealGoods,
	            @ProviderBigCompany,
	            @ProviderCountryCode,
	            @ProviderUnp,
	            @ProviderBranchCode,
	            @ProviderName,
	            @ProviderAddress,
	            @PrincipalInvoiceNumber,
	            @PrincipalInvoiceDate,
	            @VendorInvoiceNumber,
	            @VendorInvoiceDate,
	            @ProviderDeclaration,
	            @DateRelease,
	            @DateActualExport,
	            @ProviderTaxeNumber,
	            @ProviderTaxeDate,
	            @RecipientCounteragentId,
	            @RecipientStatusId,
	            @RecipientDependentPerson,
	            @RecipientResidentsOfOffshore,
	            @RecipientSpecialDealGoods,
	            @RecipientBigCompany,
	            @RecipientCountryCode,
	            @RecipientUnp,
	            @RecipientBranchCode,
	            @RecipientName,
	            @RecipientAddress,
	            @RecipientDeclaration,
	            @RecipientTaxeNumber,
	            @RecipientTaxeDate,
	            @DateImport,
	            @ContractId,
	            @ContractNumber,
	            @ContractDate,
	            @ContractDescription,
	            @RosterTotalCostVat,
	            @RosterTotalExcise,
	            @RosterTotalVat,
	            @RosterTotalCost,
	            @ApproveDate
            ) ; Select SCOPE_IDENTITY();", new
            {
                invoice.IsIncome,
                invoice.ReplicationSourceId,
                invoice.ReplicationId,
                BuySaleTypeId = invoice.BuySaleType,
                invoice.VatAccount,
                invoice.Account,
                StatusId = InvoiceStatus.A,
                invoice.Sender,
                invoice.Number.Year,
                invoice.Number.Number,
                invoice.Number.NumberString,
                invoice.DateIssuance,
                invoice.DateTransaction,
                InvoiceTypeId = invoice.InvoiceType,
                invoice.OriginalInvoiceNumber,
                invoice.SendToRecipient,
                invoice.DateCancelled,
                invoice.ProviderCounteragentId,
                ProviderStatusId = invoice.ProviderStatus,
                invoice.ProviderDependentPerson,
                invoice.ProviderResidentsOfOffshore,
                invoice.ProviderSpecialDealGoods,
                invoice.ProviderBigCompany,
                invoice.ProviderCountryCode,
                invoice.ProviderUnp,
                invoice.ProviderBranchCode,
                invoice.ProviderName,
                invoice.ProviderAddress,
                invoice.PrincipalInvoiceNumber,
                invoice.PrincipalInvoiceDate,
                invoice.VendorInvoiceNumber,
                invoice.VendorInvoiceDate,
                invoice.ProviderDeclaration,
                invoice.DateRelease,
                invoice.DateActualExport,
                invoice.ProviderTaxeNumber,
                invoice.ProviderTaxeDate,
                invoice.RecipientCounteragentId,
                RecipientStatusId = invoice.RecipientStatus,
                invoice.RecipientDependentPerson,
                invoice.RecipientResidentsOfOffshore,
                invoice.RecipientSpecialDealGoods,
                invoice.RecipientBigCompany,
                invoice.RecipientCountryCode,
                invoice.RecipientUnp,
                invoice.RecipientBranchCode,
                invoice.RecipientName,
                invoice.RecipientAddress,
                invoice.RecipientDeclaration,
                invoice.RecipientTaxeNumber,
                invoice.RecipientTaxeDate,
                invoice.DateImport,
                invoice.ContractId,
                invoice.ContractNumber,
                invoice.ContractDate,
                invoice.ContractDescription,
                invoice.RosterTotalCostVat,
                invoice.RosterTotalExcise,
                invoice.RosterTotalVat,
                invoice.RosterTotalCost,
                invoice.ApproveDate
            });

        }
   }
}
